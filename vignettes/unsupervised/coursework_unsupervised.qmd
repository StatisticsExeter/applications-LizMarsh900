---
title: "Clustering local authorities by road collision patterns"
author: "Anonymous"
format: 
  html:
    embed-resources: true
---

## The Problem

Road safety data is recorded by Police in Great Britain (<https://www.data.gov.uk/dataset/cb7ae6f0-4be6-4935-9277-47e5ce24a11f/road-accidents-safety-data>) and is split into three linked tables: accidents, vehicles, and casualties. We are interested in creating clusters of like authorities based on the kinds of collisions that occur in their area, specifically the number of the following types of collisions:

-   At a mini-roundabout

-   In the rain

-   In the dark

-   Dry conditions

-   In an urban setting

-   Most seriously injured casualty has a 'slight' injury

## The Data

The following figure shows a scatterplot matrix all the numerical variables in the dataset plotted against one another, to allow us to visualise all bivariate relationships. The proportion of each subtype of collision was used, rather the actual number of collisions, and the variables were rescaled.

![](../../data_cache/vignettes/unsupervised_classification/scatterplot.html){width="100%" height="600px"}

Upon visual inspection, the scatterplots do not appear to show many obvious associations between different types of collisions with a few exceptions. One such example is a negative correlation between the proportion of collisions in the rain versus dry weather, meaning that areas with a high proportion of collisions in the rain tend to have a lower proportion of dry collisions. This makes sense, as collisions in wet weather cannot occur at the same time as collisions in dry weather. Another set of variables that might show a relationship is dry collisions and collisions resulting in slight injury. There appears to be a positive association between the two collision types, which could make sense logically, as dry conditions might be linked to collision severity.

Finally, and importantly, the total number of collisions is highly positively correlated with many of the collision subtypes, particularly slight injuries, urban locations, and dry conditions. This again is to be expected, as the subtypes make up proportions of the total collisions. However it does suggest that these three specific collision types make up most of the proportion of overall collisions and also that total crashes accounts for most of the variation between authorities.

## Hierarchical clustering

The first analysis I carried out was hierarchical clustering analysis to help find patterns in the dataset. Specifically, I wanted to find clusters of similar local authorities based on the kinds of collisions that occur in their area. I used Ward's minimum variance method for the linkage method and created a dendrogram to visualise the clusters and the similarity or distance between them:

![](../../data_cache/vignettes/unsupervised_classification/dendrogram.html){width="100%" height="600px"}

When zooming into this graph, four visually distinct branches become apparent, as represented by the colours green, red, cyan, and purple. There is also an overarching blue branch above these four branches. Plotly automatically assigns these colours based on tree structure, but it suggests that this dendrogram should be cut off at an appropriate height to form four distinct clusters.

Before plotting the results of this clustering solution, principal components analysis (PCA) was carried out on the collision variables for the purpose of visualisation and interpretability. By doing this I was able to extract and plot the first two principal components, which preserves as much variability as possible, rather than attempting to visualise all the variables at once. As a result, a 2D graph of the results was able to be plotted, making interpretation much easier:

![](../../data_cache/vignettes/unsupervised_classification/kscatter.html){width="100%" height="600px"}

The graph shows the four clusters denoted by different colours. Cluster 4 appears to be the most spread out and the others appear to be slightly more compact. Cluster 3, denoted as green in the graph, appears to be a more poorly defined cluster, as it overlaps with neighbouring clusters (particularly cluster 2 in blue) quite significantly. The mostly well-defined cluster appears to be cluster 1 in red, which is on the far right, and also one of the smallest groups.

## kmeans clustering

Next I carried out a k-means clustering solution, which partitions the data based on which cluster has the nearest mean. Firstly we'll consider the cluster centroids:

![](../../data_cache/vignettes/unsupervised_classification/kcentroids1.html){width="100%" height="600px"}

The graph shows the average total number of collisions for each cluster. Clusters 0 and 1 are relatively similar in their averages, while cluster 3 appears to display a smaller mean number of collisions. Cluster 2 however, seems to be the most distinct, with a significantly higher mean value than any other cluster. This overall seems to suggest that total collisions is one of the main drivers of cluster formation, which was expected from the results of the scatterplot matrix.

The following graph represents the cluster centroids for all the collision sub-types:

![](../../data_cache/vignettes/unsupervised_classification/kcentroids2.html){width="100%" height="600px"}

This graph appears to show that certain collision sub-types exert more influence on clustering than others. For example, the average number of collisions at mini-roundabouts is very similar across all four clusters, suggesting it will have little impact on clustering. On the opposite end of the spectrum is the average number of collisions in an urban setting, which appears to have very different means across each cluster (cluster 2 is highest, while cluster 0 is lowest).

Taking both of these graphs in mind then, cluster 2 seems to represent urban areas, with the highest number of total collisions, and proportion of collisions resulting in slight injuries. The other clusters seem to represent less urban local authorities, in particular cluster 0 which likely represents the most rural areas. Cluster 3 possibly represents areas most affected by wet weather, with a low total collisions average but a higher average for collisions in the rain, and a lower average for collisions in dry weather.

As previously, I then plotted the cluster membership on a scatterplot of the first two principal components:

![](../../data_cache/vignettes/unsupervised_classification/kscatter.html){width="100%" height="600px"}

The graph shows four generally well-defined clusters which share a lot of similarity with the hierarchical clustering solution. The four clusters have mostly relatively similar boundaries to the hierarchical solution, with slightly less agreement about a few data points from clusters 0, 1, and 2. Cluster 1 appears to be the most poorly defined in this solution, overlapping a lot with its neighbouring clusters.

Overall, both methods of clustering present relatively similar clusters representing similar local authorities. The clusters tended to differ mostly in how urban rural they are, but some collision subtypes exerted an influence too.

## Record of AI use for MTHM503 unsupervised coursework

| **Date** | **AI tool used** | **Purpose** | **Prompt** | **Hyperlink to output (where possible)** | **Section of work used for** |
|------------|------------|------------|------------|------------|------------|
| E.g. 15/07/2025 | MS Copilot | To help create an organised essay structure | ‘Generate ideas for structuring an essay on...’ | \[insert link\] | introduction |
|  |  |  |  |  |  |
|  |  |  |  |  |  |
|  |  |  |  |  |  |
|  |  |  |  |  |  |
|  |  |  |  |  |  |
|  |  |  |  |  |  |
|  |  |  |  |  |  |
|  |  |  |  |  |  |
