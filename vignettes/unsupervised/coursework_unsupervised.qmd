---
title: "Clustering local authorities by road collision patterns"
author: "Anonymous"
format: 
  html:
    embed-resources: true
---

## Your task

This material is provided as context to the problem. You should rewrite it as you see fit. IN particular, you should demonstrate you understand why we are undertaking a cluster analysis, and what the various methods are telling us. In particular, you should explain how principal components helps us visualise the results of the clustering.

## The Problem

Police recorded data in Great Britain is called "Stats19" and is available at <https://www.data.gov.uk/dataset/cb7ae6f0-4be6-4935-9277-47e5ce24a11f/road-accidents-safety-data>. These data are typically split into three linked tables:

-   Accidents

    Each row represents a single reported accident. Key fields include:

    -   Date and time
    -   Location (e.g. latitude/longitude, local authority)
    -   Road type and conditions
    -   Weather and lighting
    -   Number of vehicles and casualties

-   Vehicles

    Each row represents a vehicle involved in an accident. Includes:

    -   Vehicle type and age
    -   Manoeuvre and direction
    -   Driver age and sex

-   Casualties

    Each row represents a person injured or killed. Includes:

    -   Casualty type (pedestrian, cyclist, driver, etc.)
    -   Severity (slight, serious, fatal)
    -   Age, sex, and mode of transport

These tables are linked via a unique accident index.

We are interested in creating clusters of like authorities based on the kinds of collisions that occur in their area. You have been given a count of the number of collisions at Mini-roundabout, in the Rain, in the Dark, when the road is Dry, in an urban setting and where the most seriously injured casualty was reported as having a slight injury.

Some previous cluster analysis work has been reported at:

-   [Cluster analysis](https://ijirt.org/publishedpaper/IJIRT175966_PAPER.pdf)
-   [More cluster analysis](https://www.researchgate.net/publication/357727987_Identification_of_Traffic_Accident_Patterns_via_Cluster_Analysis_and_Test_Scenario_Development_for_Autonomous_Vehicles/fulltext/61dcdc17034dda1b9eebd63d/Identification-of-Traffic-Accident-Patterns-via-Cluster-Analysis-and-Test-Scenario-Development-for-Autonomous-Vehicles.pdf)

## The Data

The following figure shows a scatterplot matrix all the numerical variables in the dataset plotted against one another, to allow us to visualise all bivariate relationships. The proportion of each subtype of collision was used, rather the actual number of collisions, and the variables were rescaled.

![](../../data_cache/vignettes/unsupervised_classification/scatterplot.html){width="100%" height="600px"}

Upon visual inspection, the scatterplots do not appear to show many obvious associations between different types of collisions with a few exceptions. One such example is a negative correlation between the proportion of collisions in the rain versus dry weather, meaning that areas with a high proportion of collisions in the rain tend to have a lower proportion of dry collisions. This obviously makes sense, as collisions in wet weather cannot occur at the same time as collisions in dry weather. Another set of variables that might show a relationship is dry collisions and collisions resulting in slight injury. There appears to be a positive association between the two collision types, which could make sense logically, as dry collisions might result in less serious injuries.

Finally, and importantly, the total number of collisions is highly positively correlated with many of the collision subtypes, particularly slight injuries, urban locations, and dry conditions. Obviously this again is to be expected, as the subtypes make up proportions of the total collisions. However it does suggest that these three specific collision types make up most of the proportion of overall collisions and also that total crashes accounts for most of the variation between authorities.

## Hierarchical clustering 

ADD IN DETAILS ABOUT WHAT EXACTLY HIERARCHICAL CLUSTERING DOES FOR YOU?

The following dendrogram represents the hierarchical relationships between local authorities based on their collision profiles:

![](../../data_cache/vignettes/unsupervised_classification/dendrogram.html){width="100%" height="600px"}

When zooming into this graph, four visually distinct branches become apparent, as represented by the colours green, red, cyan, and purple. Additionally there is a blue branch above these 4 branches that likely represents outliers or very distinct local authorities. Plotly automatically assigns these colours based on tree structure, but the four colours at the ends of the tree suggest that the data should form four main clusters.

In order to form these four clusters the tree was cut off at an appropriate height and plotted. For the purpose of visualisation and interpretability, principal components analysis (PCA) was carried out on the collision variables. By doing this I was able to extract and plot the first two principal components, which preserve as much variability as possible, rather than attempt to visualise all the variables at once. As a result, a 2-dimensional graph of the results was able to be plotted, making interpretation much easier:

![](../../data_cache/vignettes/unsupervised_classification/kscatter.html){width="100%" height="600px"}

The graph shows the four generally well-defined clusters denoted by different colours. Cluster 3 appears to be the most spread out and the others tending to be more tight and compact. However, cluster 1, denoted as blue in the graph, might be a somewhat more ambiguous grouping, as it overlaps with neighbouring clusters much more than other do. FINAL CONCLUDING SENTENCE?

## kmeans clustering

The second task is to perform k-means clustering. You should select an appropriate number of clusters. First, you should look at the cluster centroids:

![](../../data_cache/vignettes/unsupervised_classification/kcentroids1.html){width="100%" height="600px"}

![](../../data_cache/vignettes/unsupervised_classification/kcentroids2.html){width="100%" height="600px"}

As before you should plot the cluster membership on a scatterplot of the first two principal components.

![](../../data_cache/vignettes/unsupervised_classification/kscatter.html){width="100%" height="600px"}

## Additional credit

For additional credit you should consider adding a further unsupervised classification method. Alternatively, you could increase the number of variables used in the clustering.

## Record of AI use for MTHM503 unsupervised coursework

Instructions: You can use this document to record when, how and why you used GenAI to complete your assessment. It will help you create a record of AI use to submit alongside your references for AI-integrated and AI-assisted assignments. It may also be useful to help you discuss your AI use if you are required to do so in an academic conduct meeting.

| **Date** | **AI tool used** | **Purpose** | **Prompt** | **Hyperlink to output (where possible)** | **Section of work used for** |
|------------|------------|------------|------------|------------|------------|
| E.g. 15/07/2025 | MS Copilot | To help create an organised essay structure | ‘Generate ideas for structuring an essay on...’ | \[insert link\] | introduction |
|  |  |  |  |  |  |
|  |  |  |  |  |  |
|  |  |  |  |  |  |
|  |  |  |  |  |  |
|  |  |  |  |  |  |
|  |  |  |  |  |  |
|  |  |  |  |  |  |
|  |  |  |  |  |  |
